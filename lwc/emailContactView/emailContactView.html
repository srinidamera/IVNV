<template>
    <br />
    <!-- <template if:true={showSpinner}>
            <lightning-spinner alternative-text="Loading" size="small"></lightning-spinner>
        </template> -->
    <template if:false={totalCount}>
        <div class="slds-text-color_weak slds-m-horizontal_small slds-m-bottom_small" style="text-align: center;">
            <b>No Emails exist</b>
        </div>
    </template>
    <div if:true={totalCount}>
    <ul class="slds-timeline">
        <template for:each={emaildata} for:item="email" for:index="index">
            <li key={email.id}>
                <div class="slds-accordion">
                    <section class="slds-timeline__item_expandable slds-timeline__item_task" data-id="timeline01">
                        <div data-id={email.id}>
                            <span class="slds-assistive-text">task</span>
                            <div class="slds-media">
                                <div class="slds-media__figure">
                                    <lightning-button-icon icon-name='utility:chevronright' variant="bare"
                                        data-locator="timeline01" onclick={handleExpandCollapse} data-index={index}>
                                    </lightning-button-icon>
                                    <div class="slds-icon_container slds-icon-standard-task slds-timeline__icon"
                                        title="task">
                                        <lightning-icon icon-name="standard:email" alternative-text="email"
                                            title="Email"></lightning-icon>
                                    </div>
                                </div>
                                <div class="slds-media__body">
                                    <div class="slds-grid slds-grid_align-spread slds-timeline__trigger">
                                        <div class="slds-grid slds-grid_vertical-align-center slds-truncate_container_75 slds-no-space">
                                            <h3 class="slds-truncate" onclick={viewRecord} data-id={email.Id} title={email.Subject}>
                                                <a >
                                                    <strong>{email.Subject}</strong>
                                                </a>
                                            </h3>
                                            <div class="slds-no-flex">
                                                <span class="slds-icon_container slds-icon-utility-rotate"
                                                    title="Recurring Task">
                                                    <svg class="slds-icon slds-icon_xx-small slds-icon-text-default slds-m-left_x-small"
                                                        aria-hidden="true">
                                                        <use
                                                            xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#rotate">
                                                        </use>
                                                    </svg>
                                                    <span class="slds-assistive-text">Recurring Task</span>
                                                </span>
                                            </div>
                                        </div>
                                        <div class="slds-timeline__actions slds-timeline__actions_inline">
                                            <template if:true={email.HasAttachment} >
                                                <lightning-icon style="padding-right:6px" size="x-small" icon-name="utility:link" alternative-text="link"
                                                title="Link"></lightning-icon>
                                            </template>
                                            <lightning-formatted-date-time value={email.MessageDate} year="numeric"
                                                month="numeric" day="numeric" hour="2-digit" minute="2-digit">
                                            </lightning-formatted-date-time>
                                        </div>
                                    </div>
                                    <div id="emailDataTemplate" data-is-desired-index={index} class="collapsed">
                                        <div style="display:ruby-text">
                                            <p class="slds-m-horizontal_xx-small">
                                                <b>To:</b> {contactEmail}
                                            </p>
                                            <p class="slds-m-horizontal_xx-small" style="float:inline-end">
                                                <b>From:</b> {email.FromAddress}
                                            </p>
                                        </div>
                                        <br />
                                        <p class="slds-m-horizontal_xx-small">
                                            <b>Body:</b>
                                            <lightning-formatted-text value={email.TextBody}></lightning-formatted-text>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </li>
        </template>
    </ul>
</div>
</template>